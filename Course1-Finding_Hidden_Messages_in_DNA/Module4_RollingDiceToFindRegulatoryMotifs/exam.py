import module4

print("Randomized motif search - skipping")
print(module4.randomized_motif_search(
    [
        "TCTGAATGCTGGTGGGCTCTCCGGCTCGTACCATCCCCTCCGTTGGATCCCCCTATCATTGGAGCACAATCTTACACGCGACGAACGCGATGGAACGTGCGAGCTCGGTACGTAAAGCAAAATTCGCTGCCGAATGCGGGTTTCAGGACCTTCGGTTGTTGCAGGTTCTGGATACGAATCATCTGAATGCTGGTGG",
"GCTCTCCGGCTCGTACCATCCCCTCCGTTGGATCCCCCTATCATTGGAGCACAATCTTACACGCGACGAACGCGATGGAACGTGCGAGCTCGGTACGTAAAGCAAAATTCGCTGCCGAATGCGGGTTTCTCCCGAGTAAGGAGCAGGACCTTCGGTTGTTGCAGGTTCTGGATACGAATCATCTGAATGCTGGTGG",
"GACAGTTAACAGAGGACCATAGATTGCGGCGACCCATCGCCCCAGAACTGCCATTTTCCGGTGTCTCGACAGTAGGAAGTACATTACTGGAAGCACTTATAGTGGATCGGTGGTGTATGAACAATTTCGCACCGTACAGGATCCAGCTTTGCGAGTCTCCCGTAAGGAGCTATCCAGGATTAGTATTCTGCGACAC",
"GTACACGTTTATGGGAGCCGGCCGTCGCTCATTTATAACAGGGTGGACAATGCTGGTGGTAGATGGAAGAACATGCGGAGAATGTTATAACGTCGATAGGGGACCTGCGCTGCAGGCAACAGTTCATCGGGAGAGACAAGGACTGCAAACGTCCTTCCGACGTTGTGAGCCGATCACTTTAGTATCGCTCATCGGT",
"AGTCCAGTTAACCTCATCAGGTATGGTCCCCATAGTGCCTGCCCTCAGCTTCCACACACGGCTTACAAGGTTGACGAGAGCTCTGGCTATCTAGACTGCCCTCATCTTACTGAGGGGCCTGCCTTTTGCCATGAACAGAAGGTTTGCGCACTAAGTCCGAATGAAGGAGCACAATGACTGCGTCGAAATCTTTTGA",
"TTAAAGGAGGAGAAGACCACGTACATCGTGTGCCCACCAGGTCCGGCGACCCAACCAATTCGACATGTCCGACGTATATAGCCCGCTGGATTGCCGTCTCTAACACACAGGGAACGTCCGCAGTACCAAAGTTGTGTAGCGGTCTCTGCCTCCTGCTTTTTTTTGATTCGTTGGGGAGCGCCCGACATGTCGAGAC",
"CGCCTTGTTAGGCATTAAATTGCCTCAGAGATGTACTCATCCTTGAGAGCCGACGTAAGGACTGATGCCATTATGACTCAACTGATGACTTGACATGATTCCTCGCACGCCTTTTCGGGTATACTCCCTCCTTTGCAGCAACGATCGTGCTTTTTCTTCTGTCGACATAGCTGCATCGCCCACCAGGCCCTGAGGT",
"TCTAAGGGACGTCCATCAATTTGTTTGCCGAAAATCGCGAGCCCAGGATGTAGGCGTTCAGAACTGATACCTTCTCTGGCACAAACATAAAGCTCGAAGCAACGAAAGTCTATTCGATTACTTGGTCTATCACGTAAGGAGCGCGAGCTCTTCCCTATTTAACACCCAGCTCTTTATAACAAGGTTGGAATTCGTT",
"CTCCGACGTAACACGCCCTATACGTCTATCCACGTATCTCTCCAAGCCCGCGAGCGTACACCGCCTATTTGGTCAGGATCGAACGTTATTATTCTCCGCATTCCTGTCCGATGACGCCTGCCCTGCATCACAACCAAATATAGTGATCCCATAAACGGTTTAAGCTTATCCCAAGTGCGTTAGAAACGTTGTGTGG",
"CGTCCTTGAATCCGGAACACATCCACTTTATGCGCTCATCGTCTCCTCCAGTGTAAGGAGCCTCCACAGCACAGATATATGAACACAAAGGCGTCGGCACATACACGGTCTATACCATACATGCTCACTATATCTACGGACAGACTGCGTGCTACTGGAAACCCATGGGGGGTTCTATCATACCTGTGCATAATCT",
"GGATTCGTTTCAATCTTCACGAACAAGTACCATATGCATAACCAGGGAACTAATCCTTCCACATAGCAAAGATAATGGCATGGGTTTCATCCTCATAGACCATTGTGCGCCCGGTTGAGAACCCTTGACAGAACGAGTGTCCGACGTAAGGGAGAAGATTCCCCATGTTTTGTTTATATCGCACACGTCGGAACAC",
"AACGGGGACCGCCTACCAATCAATGTGCTGGGTCGCCGGAGGGGTGAGCTGGGTTCGGTAAGCGATTCAGCTAACATTAGCAGGGAAACAATCTAGATTGCCTTGTCTAGTTTAAGGACGTATTCTAGAATCTGCACTCTTGGCTCACGGCAATACCAGACGGAAGACGTAAGGAGCTGCCGGCCCTGCGTCACTG",
"AGCAGGAAACTTCCACTTCTAAGGAACTGAAAGCCGCACCGTAAGGCATATACGATTTCCGACCGCGTTGGCGGTGCTCCGATAGAAGGAGCGTCTACGCGCGCCAATATTCGCGGCAAGACTCAGTGCGATGTGCCTTCATATCCATACCTTGTTTAAGGATTATTGCACGCTAACAAATGAATATCCCGCAGGA",
"GGCGCTAGGATTCACTTATCGTCCGACGATTGGAGCTATGGATGCATCTTCTATCAAAGAGCATGGCGGGGCTATTGGAGATTCGCATGTTGCAACAGTGCCTATGTCAGGTACTTGCACTGGATTATCACTCCCCGTAACTACGGCAATACATTTAAGGTTGCCTGAGTACGAACCCCGAAAACACACCTGAAAG",
"AGGTCCACGAAAGAACCAGGAGATTCATAGTTGTGCAAATTCGGCGTGAAGGTGGTTATCTTGACGGTCCCTGGATACGCAATGCTACCAGGGTCGCGGCGAACAATGGTAGTCCATCGCTAACTTGTCCGCGATAAGGAGCCGAAATAGTATGGAAAGGAGCCCCCCAATCTTATGCCCTCAGTGATGCACCCAT",
"GCTGGAAAATTATTAGTAGTCTGCCACTTTTGCCAACGCAATCGGGGGAAACTTTGTGAACCATGGTGCCGAAATCATATTAATCTGGGGAACGGATGGATATCGTTCATACTCGAGTTCGCTGTCGAGCCATTAAGGATTGCTCACCACACGATCCGACTGGAGGAGCGCCGCCTCACATTTTGCGGTGGGTACC",
"TCGCCTCTTTTAATGGCGAGGAGATTGGATAGCCTCGGGTCATCCCAATGCTGCAGTCAAAAGATGCCCTATGGTCAAGGGGGACAGTGTGGATAGCGCCAATCCGTTTACCTGCGTCGTTGGGGGAGTCCGACAATAGGAGCAGTACATGCTCCGCACTTAACGTAGGGTTCCTGAAGCTTACGCCCACATCCAT",
"GACCGTCGCTCACCAGCCCTGTGTGTCGACGTAAGGAGTATCAAGGGGCCCTCTACCCCGAAGATTGAGTCTTCAGTTCGCATTAGACAGGCTGCGCGCATAATAGGCTCACCTTTAGGGGGGCATGGGCGGCAGCCACATGGCCGGTCCCCGTCCCGGTGAAGTAGTGCCTTATGGAACTCGCCTTACGGGACAG",
"GCCACATGATGCGAGATCGTGCTCTTAACTGGTTGAAATCTCGACAAAAATCCGCGTTAAGGAGCCCACGTGTCTGGGACGGATCCCTAGGCCCCGGATGGTAGACTACCCCCCATCAGTCGACCGGCACCACAAATAGTTGCTATTCGCCTGTCAAAACCATCAGGCTAAAGTTTCCCTGATCTTTATTCACTCG",
"GTGAGATCCCGAACTCGAGGCTAGGATTGCTAAAAGTATGTGTGCGGGCACTAGCGAAATCGCACACCACAGCAGCTATCAGGGTTGTTGTCCGACGTAAGTGACTTTGAGTAGCCAAGATTCCGTGGAAACATTTACAGGGGGAGTATCTGGACTGGCACAGAGAAGTTTGACACTTTACTTGGGTCCAGAGATA"
    ], 15, 20
))

print("Create random distribution")
print(module4.create_random_distribution(5))

print("Gibbs")
print(module4.gibbs_sampler(
    [
        "GCTACGAACATTACGCGCCTCGTCCTGAATGATTAGGTTAAGACTGTTCACAGAGTAAGCATTTAGGCGGGAGAGTGAGGAAGAGACACGCGCATTGGCGTGATTTTTAACTGTTATTAAGCTACTCAACCTTACAGAAGTGTGTGAACGACCAAGCTTGCTAGACTAAGGTTGAAGTCAAAACGGGTACCCATCTGTTATCTAAGGGTGTTGGTTACTGGATACGTCTTGACAGGAAAATTGCAGCGGACAAACAAGATTCCTTGTGAGTCCGCCACCTGGGGCCCGGTCGCTCGTGGCTTCAGCTACGAACATTACG",
"CGCCTCGTCCTGAATGATTAGGTTAAGACTGTTCACAGAGTAAGCATTTAGGCGGGAGAGTGAGGAAGAGACACGCGCATTGGCGTGATTTTTAACTGTTATTAAGCTACTCAACCTTACAGAAGTGTGTGAACGACCAAGCTTGCTAGACTAAGGTTGAAGTCAAAACGGGTACCCATCTGTTATCTAAGGGTGTTGGTTACTGGATACGTCTTGACAGGAAAATTGCAGCGGACAAACAAGATTCCTTGTGAGTCCGCCACCTGGGGCCCGGTCGCTTCTTGTCGCATATCTCGTGGCTTCAGCTACGAACATTACG",
"AACTAGCGGACGTTCGTGTGCTAAAGGTGTCTGGTGGTCAACCCATATTCCGAGATGGAAACACATACCACTGTCTGCCATAATATCTGCAAAGATACGTGGGTACGGGGAATGGGGTGGACGGGTTCCCATCCTAGTGCCAAAATACATGGACACTGTTAGCTACGTTAAATCTTGGGGCGTGTATTTGCTGATTATGCGCTAATTGCTCGGAATCCAGATCAGTCTCGGCGAACATGCAAGTTGGAGGATGGGCCGATCGCCGCGTTATAGGCTCCGGAGTGTTGAGGTGTTCGAAATGGCAGCGCCGATCGCGATT",
"GAAGTTGACTTCCCGTTAAGGGAATCTCCAGGCCAAGTACGCTTTTCCACCGACTGACCTTATAGTCTACTCCCGACCATCGAACCTCACAATTAATTCTTGTGTCCGGCATTTCATCAGACCCATATTGTATGAACTCTCTTCGCATATCTTCGTCGGTGCAGTCCTATATACTGGCCCTTATTTGGGACGCGTAATGACCTCGCTGGGCCGCTGCACCGCATTGCAGACTTACAACGAGAGGCACACTTTACGAGACAGATGCGACTTTCGATGTTAGAGACTAATCCCTTCGCACCGGTTCCGGGTAGGTCGATTC",
"ATACGCCAAAAGTGATGCGAATCGAGTTTTAGGCCCTCCTCGCCGTTGCACATCCCCTTATCTCAGAAACACCGACGTCTTTCCGGATGCAGCTAGACTGATCCAACTCTACTATAGGACACACGTGCCGACGAAACCTCCTAGTGGACCTAGTAAGACACTCGCGCTTCCAAAGAATGAGGCTCTGTGAGCATATCTCCTATAGCTGCATTTTCGTCGCTTCGGGTCCTAACGTAGTCACCGGGACGTGCCTAATCACGTAGACAACGACCTGTGCAAAACTCACCAGTAGCAGGAACCCCTATGGAGTATAGGGCCC",
"GATTAGGAGTCAGTTACTCGTAACTATCACTGGCCGGCGGCTACTACCCACAGTATAAAATACTAGGTACTGGGCCACGCCCCCAAGACGCTCTCGCCTCCTACCGAACGGCCACTGAAGCAACTTACCCGAAGCGATAGCGAGCTACTTTCTGCTGACATATCTATTAGATGAACGCTACACAACTTTTATAACCAGGCCAACATATAACAGGTTCCATAGTCGTTAAGACTGTGCGGTAGTCGCTAAGATTAGTTAGAGGCCTAGCAAGTTCGCCGAAGACTCGGCCTGCCAATTCGAAGGGTCATATTACCGTCAC",
"TGATAGGATACTCCGCCATCAAGCTGAAACCCTATTGGCCGTCCTACAGAACGTCGAGACCTGTTATGTAATTCCGACAGGCCAGATAGTAAAGCGTGACTAATCAAACGGTAATTCTCTCCTCCTCTGCCCGCATCGTTGCTGCAACAGTTGCTAGTGGCAGGGTTATCAAGCCTCTACTCAAGACTACCCTAGAATGAAAGTTTTGGCGTTGACGCTGAGTCAAGCAGCCCCTTTCATTCCGGAAGGATTGAGTACAGAGTTAACGCACGACAAACTTGCGATTCAACCCTATTGGACGGATGCGCTTGCGTGGACG",
"AGATTATCCTTGCCGTGCTGTGCCCGGAGTAACCTAAAGCCTAGCGTTCACTAACGAGCTGTTTGGCCGGGCTATCTCTCATAATCGCAAGACAGCGACCCGACGACTAACTCTGGCCGTAGCCGCAGGCTCTGCCCGCATACGCTTTCAGCGGGTCATAACGCGTGTGCATCGCTGTAAGAAAGGAAAGTTATCCTACCATAGTCTACGAAGGAGATACTTCAATGGTCAGAAGTGCGTTTATCTAGCCGTTCACAGCAGAGTTCTGCAGCATATTCGCCGATGTCCGACAGTCAGCGGTTTCATCCGAGCTCCTCAA",
"TATGGGGCCTCCAAGCACTTTTCGGTTCTCCATAGTGCTGCCTATACACCAAGTATCATATCTCCGGCGGACTGGTAAAGTACTATCGAGCGCCTAGGTTCAATAGACCGAAAAGTGCTGGACACTGTAGGACAGAAAGACGCCTCAAGTCCCGGGCCCGTACGAGTTGGTTTCGTGTGATTGTTGACGGTTAAAAAAGCAGATCGGCAATGTCTGCCGTAATATCTAAAACCCCTATCGAGCTATACAAAATCAATAAAGGAATACTCCATCCTGTCCAAACTGTGCACATCTATCACATGGAGGAGACTGCACGGCT",
"TCAATTAGGACGATTTCGCGCCCCTGCCCCGTTGTTGCGATCTGAGTGCATATCTCCGGGGCCCATCTAAGACCCGGAGCGTCTTACGAGCGGCTTTATGCGTAAGACTCTCAACTATCCAGGAAAACATGCCAGTCTACGATCTCTGGGAGAATTCGGCGGTACCCGAACAGAGCTCTGAGTTAAACGAACGAACGGTGCCCTGCGAACGTTTCACAGATGGTAATAACGGTGTCACTTAGGGATTCGTTGATTGAGGCAGGACTAACTATAGAAAAGGTTCCGTGTCTGCCCACGACGCGGGTAAAAAGATTTATTG",
"AGGCACACTCGTTAGTGTTTAAACTGGTGACGCTGAAAAGAGGACAGCCTTGTCTGAAGAACTGAGGTCGGTACTGTCAACCCCCCTTGTTCCGGCTGAGGTAGCACTCTTTAGGTATCAGGGATTAGGCCAGAGACTTAGTTCTCAGATACTGTGCATGCCATACGCCTTTACATCTGGGGTCTTCAAGCTAACCCTATTGCGCAGTAAAAGTGCGGATGAGGTGCCACAAAAAACGTCTGCCCATTTATCTTCCGGGCCCAGGCCGATTGGTTCCAGATCCGGTCGTGAATGTGTAGTCGGGCGCGTCCTGGGGTAT",
"TAATTAGCCCTATTACTTTACGGACAGACTTCTCCTATCCCACATAGCCGGCATTTTGCGCGAATTGATTGTACCCTTATACTATGTATCAATGCGTAAGACGGGCTACAGCTCGTGCCTCTAGCAGTGGCAAGGTTGTTCCACTGGGACAATGGACTTACAAGCCTCCTGGTAGTGCCCGCATATCCACGGTGCCAGGCCGTGCGGCGAAATCCAAGTGTCGTGTGGTTTCCCCATAAATTGGTGCGTTGCGGGCGATGTGTTGGCCTCTGTCATTAGTCGTGGGATTACAGCCCTCGGGTTCTGCTGTTGGCGTAGG",
"CTTTTAACTTTTCCTTCGATACCCAAAACCTGGGTACCTCACACACGTCACGAGCTTACCGTAAGAGGGAAGTCGGTGCGCAATTACGGCACCATACCCCGTCGTTCATCAATGCGACTTCGCCGAAATACATGAGGAGTAATAGGGCTGGTGAATTCCTCATGTTCCGAAGATAAGGGGACTGAGGTACTTGCAGCTGCGGCCCATTCCAGGCCTTTGTTTACGCTCCACGCGGAGGCTCCTGCTACTAAACCAAACATGTGGAATTTAGGCAGTGCTCATGTGTCGAGCCCGCATATCTATCAGAAGGAACTCGGCA",
"GTGGGCACAGTAATATGGAGCCCGCCTTGGTAGGTGTATCGTTGACTGCGCTTAGTAATATTGGCCTGCACTCTAGCTTCAATCGGTATAATGCGACTTTATAAAACTAGGACACGAATGGGATACAGTCAAATATGTGGGACTGAGTCGCGTTGGTGGATATGGGCCCTCTTGTTGGGACTGAGTTACTCTATCTGACGTGATCTGCCCGCTCTTCTGTCTAATTATAAGCCTATTCCAGGACAAACTAGATGCTAGTTTGGGTGATGTCCCTCCTCGATTCAGAGAAACCCATGAACCGACTGAGAAGTTTGATTAG",
"TGGAGTCTTATCTCTAAGTTTTGTTGAATGCCAGTAACGCCTCCCTTAGCTTGGCTGCCCGCATATTCTTGAGGGCGGTCGAGTTAAGGCGCTCCCGCGGTCTGGATAGTCCCATCTCTCACTTATAGGTATTCAGCTGCAGATAGGGGTCTTACGCCAGAATATTTCTGAACTTAGAAGCCGCACGATGCACGCACCGCTCGATCCAGAGGTCGCACAATAATTTAGAATGGGTACCTTAAGTGCAGTTTATACCATGTCGGGCACTCGGTTTTTTCTCAAAGGTCCGCCACCGGCTTAAAGACCGGTGGACATTCAC",
"CCACGGCGGCGAGAGCTGACAGATTGAATCGTAACCGCTATCGAGGCGGTATTCTGGACACATGGTGCAGTGAGTGCAATATGAACAAAACTGGCTTCCGTCGAAATGCGTTGGTTATAAGTCAGCAATTTTCACAATCGTGCCTACAGACGAGCGCATGCACCCGCATATCTCGCACGCTGGCTTTACCGGGCAAGCCAAGCTGGTCGACGAGCAACGGCGGCACCCGGAGGGACAGTCGACTGTAGTGATGCATGATTCAAGCTAAAGGAGTTCGACGTTATTACTACACCGTCTAACCTCGGTTTAGGAAAGAGTG",
"TCCCACCGACGTCCCTAACGAAGTTCTCCCGCAAAACTGCCTAATATTCATTGCACCTACTCGTACATGATCACGACCACGGGCAGTTCTCTGGTCTGAAGAGCCTCGGCGATGTTATGAGTGCCACGTTCATAAAAGATGACCGGCGGTGATACGTGAATACTATATCTGATTATAGACATATCGTTCTGCGTACATATCTCGAGACTCATGTAACATAGAAGAGAATAACCCATATCGAAACCCGCGGGGTTAAGCCAGATGTCAACTCAAAAAGTGTAACATGGCTCATAGCTGGTAGGGCCCAAATGCAGGGCAA",
"ATCACCGCTCTCCCGTCGCCGTATAGGGGTCAGACTTTCTGGAGTCTGCCCGCAGTACTATCTGATAGTATCCCTCAAATATGGGATCATCTCTCCTCTACATGATCATGTTCAAATTAAACCCGAGGGGGGGGTGTCACCGACTTTGCTCCAAAGGTGCAGGTGTAATACCTTGATTATCGGCTGTGATACATGTCTCGGAGGCGACGGGCGGCCTGACCAATGAATCGTTGGAAGCGATCACGGATATATACCATGTATCGTTCAAATCACGGGTCAGCTCCCCGAGACCTGTATGATTATGCTCAGCCCTGATTAA",
"CGTCTCCAATTATAAGGGGGATAGTCATCCGCCGCAAGCGAAACTGACCTGGTTCAATGATATTCCTCTCTAGACTGCTTAATATTAGATGTGAGTTGTCGTTCCTGCTACCCCCACCGTTGTAATTCCTACCGCATATCTGCGACCGTGACCCCGCAGCATGCCAACGTCCATTTAAGCCTTACCGATTAACATTCAGTCCATTTGTACATGAAACTGCGTGTTGTTATGAATTCGTTATTCCTGAGGAGTTCAGCAGACATAAGACAGGTTTGAGGATCAGCACCGATCTAATCCGGTCGGGTTATTCTTTGCGGAG",
"GCGGTGTTAGACCCTTCGAAATTACCCCCTGGATACTGGCCCCGTGCTCAGGCACCGCTTAAGAGATCTTTGAGTTCCCGATGGAGGTGAATGACTCCTCTGCCCGGGGATCTTCTCTTATGGCACTTTGCCGATTAGAAGTCTTTTTCCTTACTCAACCGAGTAATGGTTCTATGAACTAGCGATTCGCCAGGGCGACATCTTAGACGGCTTATATGCCCGCGGTGGCAGACTTGGAACTTATTGTCGGAACAGCCATGCAAGAATGCGGGTGCTAGTGGCCAAGGATCTGCTCAGTGACCATAGATGTACTCGGAAT"
    ],
    15, 
    20, 
    2000))

def randomized_motif_search_one_loop(dna_strings:list[str], init_motifs:list[str], k: int, t: int) -> list[str]:
    """
    RandomizedMotifSearch
    Input: Integers k and t, followed by a space-separated collection of strings Dna.
    Output: A collection BestMotifs resulting from running RandomizedMotifSearch(Dna, k, t) 1,000 times. Remember to use pseudocounts!
    """
    number_dna_strings = len(dna_strings)
    assert t == number_dna_strings
    assert t > 1

    # Init of motifs as randomly selected k-mers of every dna string
    local_motifs = []
    best_local_motifs = []

    best_local_motifs = init_motifs

    profile_matrix = module4.compute_profile_matrix_with_pseudocounts(best_local_motifs)
    for d in dna_strings:
        d_kmer = module4.profile_most_probable_kmer(d, k, profile_matrix)
        local_motifs.append(d_kmer)
    print("score local: ", module4.score_motifs(local_motifs), 
          "score init: ", module4.score_motifs(best_local_motifs))
    print(local_motifs)

    return local_motifs

randomized_motif_search_one_loop(["TGACGTTC", "TAAGAGTT", "GGACGAAA", "CTGTTCGC"], ["TGA", "GTT", "GAA", "TGT"], 3, 4)
